[gd_scene load_steps=31 format=3 uid="uid://u1m0kcl66o30"]

[ext_resource type="Script" uid="uid://bsyte60sr0ow1" path="res://scripts/player.gd" id="1_v0iea"]
[ext_resource type="Script" uid="uid://bvsnf05yau30i" path="res://scripts/spring_arm_pivot.gd" id="2_cvnsp"]
[ext_resource type="PackedScene" uid="uid://b1nkskto4lhnf" path="res://Assets/Personaje/tukuy_2.glb" id="2_vgqql"]
[ext_resource type="Script" uid="uid://bpi3qiai0b2k" path="res://scripts/camera_3d.gd" id="3_6t5aa"]
[ext_resource type="Texture2D" uid="uid://7gtrh4r3lqf1" path="res://Assets/Personaje/tukuy_fantasmita_DefaultMaterial_BaseColor.png" id="3_8erm5"]
[ext_resource type="Texture2D" uid="uid://dpwn60oh60sio" path="res://Assets/Personaje/fantasmita_DefaultMaterial_Emissive.png" id="4_f1ek2"]
[ext_resource type="Texture2D" uid="uid://cyhuc0w56xl1q" path="res://Assets/Personaje/tukuy_fantasmita_DefaultMaterial_Normal.png" id="5_tx1dd"]
[ext_resource type="Texture2D" uid="uid://bxr3mopjwjkh5" path="res://Assets/Personaje/tukuy_fantasmita_DefaultMaterial_OcclusionRoughnessMetallic.png" id="6_gymyn"]

[sub_resource type="ORMMaterial3D" id="ORMMaterial3D_pu2lt"]
albedo_texture = ExtResource("3_8erm5")
orm_texture = ExtResource("6_gymyn")
emission_enabled = true
emission_texture = ExtResource("4_f1ek2")
normal_enabled = true
normal_texture = ExtResource("5_tx1dd")

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_tx1dd"]
animation = &"Doublejump"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8erm5"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_f1ek2"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gymyn"]
animation = &"simplejump"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tx1dd"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gymyn"]
xfade_time = 0.1
switch_mode = 1
advance_mode = 2
advance_condition = &"run"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pu2lt"]
xfade_time = 0.1
switch_mode = 1
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ukyrk"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"jump"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8erm5"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"jump"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_f1ek2"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"jump"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7dp3o"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_h4iuc"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"run"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fd4e3"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"simpJump"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qqcod"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_igrcy"]
xfade_time = 0.3
switch_mode = 1
advance_mode = 2
advance_condition = &"run"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_ukyrk"]
states/Start/position = Vector2(183, 100)
states/doublejump/node = SubResource("AnimationNodeAnimation_tx1dd")
states/doublejump/position = Vector2(562, 186)
states/idle/node = SubResource("AnimationNodeAnimation_8erm5")
states/idle/position = Vector2(353, 100)
states/run/node = SubResource("AnimationNodeAnimation_f1ek2")
states/run/position = Vector2(353, 186)
states/simplejump/node = SubResource("AnimationNodeAnimation_gymyn")
states/simplejump/position = Vector2(553, 100)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_tx1dd"), "idle", "run", SubResource("AnimationNodeStateMachineTransition_gymyn"), "run", "idle", SubResource("AnimationNodeStateMachineTransition_pu2lt"), "simplejump", "doublejump", SubResource("AnimationNodeStateMachineTransition_ukyrk"), "idle", "simplejump", SubResource("AnimationNodeStateMachineTransition_8erm5"), "run", "simplejump", SubResource("AnimationNodeStateMachineTransition_f1ek2"), "simplejump", "idle", SubResource("AnimationNodeStateMachineTransition_7dp3o"), "simplejump", "run", SubResource("AnimationNodeStateMachineTransition_h4iuc"), "doublejump", "simplejump", SubResource("AnimationNodeStateMachineTransition_fd4e3"), "doublejump", "idle", SubResource("AnimationNodeStateMachineTransition_qqcod"), "doublejump", "run", SubResource("AnimationNodeStateMachineTransition_igrcy")]
graph_offset = Vector2(-50, -13)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_f60y1"]

[sub_resource type="SphereShape3D" id="SphereShape3D_v0iea"]
radius = 2.5809

[sub_resource type="SphereShape3D" id="SphereShape3D_6t5aa"]

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_8erm5"]
bg_color = Color(0.25281683, 0.0006389357, 0.42094475, 1)
corner_radius_top_left = 20
corner_radius_top_right = 20
corner_radius_bottom_right = 20
corner_radius_bottom_left = 20

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_f1ek2"]
bg_color = Color(0.6, 0.29803923, 0.6, 1)
corner_radius_top_left = 20
corner_radius_top_right = 20
corner_radius_bottom_right = 20
corner_radius_bottom_left = 20

[node name="Player" type="CharacterBody3D" groups=["Player"]]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 0, 0)
script = ExtResource("1_v0iea")
SPEED = 8.0
aceleracion = 40
desaceleracion = 0.13
JUMP_VELOCITY = 15
gravity = 38.0

[node name="tukuy_2" parent="." instance=ExtResource("2_vgqql")]

[node name="tukuy_armature" parent="tukuy_2" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Skeleton3D" parent="tukuy_2/tukuy_armature" index="0"]
bones/0/position = Vector3(0.0077462085, 0.30980083, 0.0010712062)
bones/0/rotation = Quaternion(0.012458693, 0.006141001, 0.019284561, 0.99971753)
bones/0/scale = Vector3(1.0014992, 1.0014988, 1.0014988)
bones/1/rotation = Quaternion(5.8298577e-10, 6.2573224e-10, -8.731145e-10, 1)
bones/2/rotation = Quaternion(1.5759407e-09, 4.0745357e-10, 5.8207716e-11, 1)
bones/3/rotation = Quaternion(1.4406107e-09, 6.548361e-10, -1.8044369e-09, 1)
bones/4/rotation = Quaternion(-0.0028215074, -0.0030480556, -0.046282224, 0.99891984)
bones/5/rotation = Quaternion(0.025098763, 0.0026645958, 0.029339168, 0.9992509)
bones/5/scale = Vector3(1.0000002, 1, 1.0000002)
bones/7/rotation = Quaternion(-4.698161e-08, -2.8472973e-08, -0.69363236, 0.72032917)
bones/8/rotation = Quaternion(-0.0022852833, 0.0014952433, -0.07126855, 0.9974535)
bones/9/rotation = Quaternion(1.4263367e-07, 5.2849675e-08, -0.45042115, 0.89281625)
bones/11/rotation = Quaternion(-4.7303928e-08, 2.8154716e-08, 0.69363236, 0.72032917)
bones/12/rotation = Quaternion(-0.0020559083, 0.0016205019, 0.07193671, 0.99740577)
bones/12/scale = Vector3(1.0000001, 1, 0.99999964)
bones/13/rotation = Quaternion(1.4357099e-07, -5.108918e-08, 0.45042115, 0.89281625)
bones/15/rotation = Quaternion(0.0068116267, 3.2793434e-08, -0.7276698, 0.6858939)
bones/17/rotation = Quaternion(0.0068116277, -3.209626e-08, 0.7276698, 0.6858939)
bones/19/rotation = Quaternion(-0.061486263, -0.15197565, -0.7184061, 0.67602926)
bones/21/rotation = Quaternion(-0.061486274, 0.15197565, 0.7184061, 0.67602926)
bones/23/rotation = Quaternion(0.0152807515, 0.0026051314, -0.7065869, 0.70745647)
bones/25/rotation = Quaternion(0.015280748, -0.0026051295, 0.70658684, 0.7074565)
bones/27/position = Vector3(2.7276877e-11, 0.24494465, 0.0014746955)
bones/27/rotation = Quaternion(0.51080185, 0.48895976, 0.51080185, -0.4889596)
bones/28/rotation = Quaternion(-0.7204468, -7.9368164e-08, 1.5390268e-07, 0.69351023)
bones/30/position = Vector3(1.9706918e-10, 0.24494466, 0.0014746954)
bones/30/rotation = Quaternion(0.51080185, -0.48895976, -0.51080185, -0.4889596)
bones/31/rotation = Quaternion(-0.7204468, 7.9368164e-08, -1.5390268e-07, 0.69351023)

[node name="tukuy" parent="tukuy_2/tukuy_armature/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("ORMMaterial3D_pu2lt")

[node name="AnimationTree" type="AnimationTree" parent="tukuy_2"]
tree_root = SubResource("AnimationNodeStateMachine_ukyrk")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/idle = false
parameters/conditions/jump = false
parameters/conditions/run = false
parameters/conditions/simpJump = false

[node name="Colision" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_f60y1")

[node name="Interaccion" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Interaccion"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.03657, 0)
shape = SubResource("SphereShape3D_v0iea")

[node name="Interaccion_label" type="Label" parent="."]
offset_left = 4.0
offset_top = 977.0
offset_right = 432.0
offset_bottom = 1060.0
theme_override_font_sizes/font_size = 60
text = "Interactuar \"E\""

[node name="salto_timer" type="Timer" parent="."]
wait_time = 0.5
one_shot = true

[node name="SpringArmPivot" type="Node3D" parent="."]
transform = Transform3D(-0.987688, 0, -0.156434, 0, 1, 0, 0.156434, 0, -0.987688, 0, 1.61306, 0)
script = ExtResource("2_cvnsp")

[node name="SpringArm3D" type="SpringArm3D" parent="SpringArmPivot"]
collision_mask = 2
shape = SubResource("SphereShape3D_6t5aa")
spring_length = 6.0

[node name="SpringArmPosition" type="Node3D" parent="SpringArmPivot/SpringArm3D"]

[node name="Camera3D" type="Camera3D" parent="SpringArmPivot" node_paths=PackedStringArray("spring_arm")]
current = true
script = ExtResource("3_6t5aa")
spring_arm = NodePath("../SpringArm3D/SpringArmPosition")
lerp_power = 6.0

[node name="CoyoteTimer" type="Timer" parent="."]
wait_time = 0.3

[node name="StairsBehaind" type="RayCast3D" parent="."]
target_position = Vector3(0, -0.75, 0)

[node name="StairsAhead" type="RayCast3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.0274582e-08, 0.2915089, 0.9213748)
target_position = Vector3(0, -0.75, 0)

[node name="BarraVida" type="ProgressBar" parent="."]
anchors_preset = -1
anchor_right = 0.19900002
anchor_bottom = 0.044000003
offset_left = 45.0
offset_top = 41.0
offset_right = 44.919983
offset_bottom = 41.479996
theme_override_styles/background = SubResource("StyleBoxFlat_8erm5")
theme_override_styles/fill = SubResource("StyleBoxFlat_f1ek2")
rounded = true
show_percentage = false

[node name="invulnerable_timer" type="Timer" parent="."]

[connection signal="body_entered" from="Interaccion" to="." method="_on_interaccion_body_entered"]
[connection signal="body_exited" from="Interaccion" to="." method="_on_interaccion_body_exited"]
[connection signal="timeout" from="salto_timer" to="." method="_on_salto_timer_timeout"]
[connection signal="timeout" from="CoyoteTimer" to="." method="_on_coyote_timer_timeout"]
[connection signal="timeout" from="invulnerable_timer" to="." method="_on_invulnerable_timer_timeout"]

[editable path="tukuy_2"]
